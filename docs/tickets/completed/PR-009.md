# PR-009: Bildbearbeitung vor Analyse (Crop, Helligkeit, Kontrast)

**Status:** ğŸŸ¢ Erledigt
**PrioritÃ¤t:** âš¡ Mittel
**Typ:** âœ¨ Feature
**Erstellt:** 2026-02-18
**Erledigt:** 2026-02-19

## Beschreibung
Wenn ein User ein Foto macht oder hochlÃ¤dt, muss er es **vor der Analyse** bearbeiten kÃ¶nnen. Ziel: Exakte TextblÃ¶cke auswÃ¤hlen (z.B. aus BÃ¼chern mit Bildern) und die BildqualitÃ¤t fÃ¼r die OCR/Analyse optimieren.

## Umsetzung

### Neuer Flow
1. User macht Foto / lÃ¤dt Bild hoch
2. **ImageEditor** Ã¶ffnet sich inline im Kamera-Tab (ersetzt Kameraansicht)
3. User kann Bild zuschneiden (Crop) und Helligkeit/Kontrast anpassen (Slider 50â€“150%)
4. "Ãœbernehmen" â†’ Canvas-Verarbeitung (Crop + Filter) â†’ OCR mit bearbeitetem Bild
5. "Abbrechen" â†’ ZurÃ¼ck zur Kamera

### Technische Details
- **Library:** `react-image-crop` fÃ¼r Crop-UI (touch-fÃ¤hig, React 19 kompatibel)
- **Live-Vorschau:** CSS `filter: brightness() contrast()` auf dem Bild (GPU-beschleunigt)
- **Finale Verarbeitung:** Canvas `ctx.filter` + `ctx.drawImage()` bei BestÃ¤tigung
- **Kamera-Lifecycle:** Stream wird gestoppt wenn Editor offen, neugestartet bei Abbrechen
- **OCR-Loading:** `isOcrPending` aus `useActionState` zeigt Lade-Overlay nach BestÃ¤tigung

### Betroffene Dateien
- [x] `src/components/image-editor.tsx` â€” **NEU** â€” ImageEditor-Komponente
- [x] `src/components/ui/slider.tsx` â€” **NEU** â€” shadcn/ui Slider (via CLI)
- [x] `src/app/page.tsx` â€” `capturedImage` State, Capture/Upload-Flow umgeleitet, Editor-Integration
- [x] `src/app/globals.css` â€” react-image-crop CSS-Overrides (Pharos Blue)
- [x] `package.json` â€” `react-image-crop` Dependency

### Nicht in v1 (optional fÃ¼r spÃ¤ter)
- Rotation (90Â°-Schritte)
- Pinch-to-Zoom
- Undo/Redo (Reset-Button reicht)
