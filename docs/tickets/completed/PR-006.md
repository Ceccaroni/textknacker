# PR-006: PDF-Export verbessern

**Status:** ğŸŸ¢ Erledigt
**PrioritÃ¤t:** âš¡ Mittel
**Typ:** ğŸ› Bug
**Erstellt:** 2026-02-18
**Erledigt:** 2026-02-19

## Beschreibung
Der PDF-Export ist grundsÃ¤tzlich eingerichtet, hat aber drei Probleme die behoben werden mÃ¼ssen.

## Aktueller Zustand
1. Kein Logo im PDF
2. Format ist mÃ¶glicherweise nicht exakt A4
3. Markdown-Zeichen (`***`, `###` etc.) werden roh ausgegeben statt in Formatierung umgesetzt

## GewÃ¼nschter Zustand
1. **PHORO Read Logo** oben rechts im PDF platzieren
2. Ausgabeformat ist **exakt A4** (210 Ã— 297 mm)
3. **Markdown wird sauber gerendert:** Ãœberschriften (`###`) werden zu echten Ãœberschriften, Fett (`***`/`**`) wird zu fettem Text, Listen werden zu Listen usw.

## Betroffene Dateien
- [x] `src/lib/export.ts` â€” PDF-Export-Funktion (`exportPdf`)
- [x] `public/logo-phoro.svg` â€” SVG von CSS-Klassen auf inline `fill`-Attribute umgestellt

## Umsetzungsschritte
- [x] PDF-Export-Code identifizieren â†’ `src/lib/export.ts` (extrahiert aus page.tsx in PR-007)
- [x] Logo-Asset finden und oben rechts einbinden â†’ SVGâ†’Canvasâ†’PNG Pipeline
- [x] **Logo-Fix:** CSS-Klassen (`.st1{fill:...}`) durch inline `fill`-Attribute ersetzt â€” Canvas-Rendering ignoriert `<style>` in SVGs
- [x] A4-Format sicherstellen â†’ war bereits korrekt (`format: 'a4'`, 210Ã—297mm)
- [x] Markdown-Parser â†’ war bereits korrekt: `parseTextBlocks` + `parseInlineSegments` entfernen alle MD-Zeichen
- [x] Test-Export: Logo sichtbar, Headings/Bold/Listen korrekt formatiert

## Notizen
- **Root Cause Logo:** Browser-Limitation â€” `<style>`-Elemente in SVGs werden bei `Image`â†’`Canvas`â†’`toDataURL` ignoriert. Fix: inline `fill`-Attribute statt CSS-Klassen.
- **Markdown-Rendering** funktionierte bereits korrekt durch die Block-Parsing-Pipeline (`parseTextBlocks` entfernt `#`/`-`-Marker, `parseInlineSegments` entfernt `**`/`*`-Marker).
- AbhÃ¤ngigkeit zu PR-008: Wenn User Open Dyslexic gewÃ¤hlt hat, muss der PDF-Export diese Schrift verwenden statt Helvetica.
