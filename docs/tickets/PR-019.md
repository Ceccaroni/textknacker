# PR-019: Vorlesefunktion auf OpenAI TTS umstellen

**Status:** üü° In Arbeit
**Priorit√§t:** üî• Hoch
**Typ:** ‚ú® Feature
**Erstellt:** 2026-02-19
**Erledigt:** ‚Äî

## Beschreibung
Die aktuelle Vorlesefunktion nutzt die Web Speech API des Browsers. Die Stimmen klingen robotisch und sprechen Fremdsprachen mit dem Akzent der Systemsprache. F√ºr ein mehrsprachiges Schweizer EdTech-Tool inakzeptabel.

## Aktueller Zustand
- Browser Web Speech API (window.speechSynthesis)
- Generische Computerstimme
- Fremdsprachen klingen falsch (z.B. Franz√∂sisch mit deutschem Akzent)

## Gew√ºnschter Zustand
- **OpenAI TTS API** als Ersatz
- Nat√ºrlich klingende Stimmen in allen unterst√ºtzten Sprachen
- Sprache wird automatisch aus dem vereinfachten Text erkannt
- Korrekte Aussprache und nat√ºrlicher Sprachfluss

## Betroffene Dateien
- [ ] `src/app/api/tts/route.ts` ‚Äî NEU: API-Route f√ºr OpenAI TTS
- [ ] `src/app/page.tsx` ‚Äî Web Speech API ‚Üí Audio-Objekt mit Pause/Resume
- [ ] `src/lib/text-parser.ts` ‚Äî truncateAtSentenceBoundary() Hilfsfunktion
- [ ] `firebase.json` ‚Äî OPENAI_API_KEY zu secrets hinzuf√ºgen

## Umsetzungsschritte
- [ ] Ticket anlegen, TICKETS.md aktualisieren
- [ ] truncateAtSentenceBoundary() in text-parser.ts
- [ ] API-Route erstellen (Zod, stripMarkdown, truncate, OpenAI fetch, mp3 stream)
- [ ] page.tsx umbauen (speechSynthesis raus, Audio-Objekt rein)
- [ ] firebase.json aktualisieren
- [ ] Build pr√ºfen
- [ ] Testen (DE, FR, IT, EN)
- [ ] Doku aktualisieren

## Technische Details
- Endpoint: `POST https://api.openai.com/v1/audio/speech`
- Modell: `tts-1`
- Stimme: `nova` (Default)
- Output: mp3
- Max Input: 4096 Zeichen ‚Üí Abschneiden an Satzgrenze
- Kein OpenAI SDK n√∂tig ‚Äî direkter fetch-Call

## Notizen
- OpenAI TTS erkennt die Sprache automatisch aus dem Text
- F√ºr R√§toromanisch evtl. eingeschr√§nkte Qualit√§t
- Echtes Pause/Resume m√∂glich (besser als Web Speech API)
